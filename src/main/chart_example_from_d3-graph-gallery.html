<!-- Code from d3-graph-gallery.com -->
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    
    <!-- Load d3.js -->
    <script src="https://d3js.org/d3.v4.js"></script>
  </head>
  <body>
    <!-- Create a div where the graph will take place -->
    <div id="my_dataviz"></div>

    <script>

    // set the dimensions and margins of the graph
    var margin = {top: 10, right: 30, bottom: 30, left: 40},
      width = 400 - margin.left - margin.right,
      height = 400 - margin.top - margin.bottom;

    // append the svg object to the body of the page
    var svg = d3.select("#my_dataviz")
    .append("svg")
      .attr("width", width + margin.left + margin.right)
      .attr("height", height + margin.top + margin.bottom)
    .append("g")
      .attr("transform",
            "translate(" + margin.left + "," + margin.top + ")");

    
    function createGraph(data) {

      // Initialize the links
      var link = svg
        .selectAll("line")
        .data(data.links)
        .enter()
        .append("line")
          .style("stroke", "#aaa")


      // Initialize the nodes
      var node = svg
        .selectAll("g")
        .data(data.nodes)
        .enter()
        .append("g")


      node.append("circle")
        .attr("cx", 0)
        .attr("cy", 0)
        .attr("r", 20)
        .style("fill", "#69b3a2")
      
      node.append("text")
        .attr('text-anchor', 'middle')
        .attr('alignment-baseline', 'middle')
        .text(d => d.id)

      // // /* Define the data for the circles */
      // // var elem = svg.selectAll("g")
      // //     .data(data.nodes)
    
      // // /*Create and place the "blocks" containing the circle and the text */  
      // // var elemEnter = elem.enter()
      // //     .append("g")
      // //     .attr("transform", function(d){return "translate("+d.x+",80)"})
  
      // // /*Create the circle for each block */
      // // var circle = elemEnter.append("circle")
      // //     .attr("r", function(d){return d.r} )
      // //     .attr("stroke","black")
      // //     .attr("fill", "white")
 
      // // /* Create the text for each block */
      // // elemEnter.append("text")
      // //     .attr("dx",-20)
      // //     .attr("dy",".35em")
      // //     .text(function(d){return d.label})

      // var nodes = svg.selectAll("g")
      //     .data(data);

      // var g = nodes.enter().append("g")

      // g.append("circle")
      //   // .attr("class", function(d) {
      //   //   return d.ratingCategory;
      //   // })   
      //   .attr("r", d => d.r )
      //   .attr("id", d => d.id)
      //   .attr("x", 40)
      //   .attr("y", 40)
      //   // .on("mouseover", function(d) {
      //   //   showPopover.call(this, d);
      //   // })
      //   // .on("mouseout", function(d) {
      //   //   removePopovers();
      //   // });

      //   // g.append("text")
      //   //   .attr('text-anchor', 'middle')
      //   //   .attr('alignment-baseline', 'middle')
      //   //   // .attr("dx",12)
      //   //   // .attr("dy",".35em")
      //   //   .text(function(d){
      //   //     return d.id;
      //   //   });

      // //     // Initialize the nodes
      // // var node = svg
      // //   .selectAll("g")
      // //   .data(data.nodes)
      // //   .enter()
      // //   .append("g")
      // //   // .attr("translate", function(d, i) { return "translate(0," + i + ")"; })

      // // node.append("circle")
      // //   // .attr("x", function(d){ return 64})
      // //   // .attr("y", function(d){ return 72})
      // //   .attr("r", 20)
      // //   .style("fill", "#69b3a2")
      
      // // node.append("text")
      // //   .text(d => JSON.stringify(d))

      // Let's list the force we wanna apply on the network
      var simulation = d3.forceSimulation(data.nodes)                 // Force algorithm is applied to data.nodes
          .force("link", d3.forceLink()                               // This force provides links between nodes
                .id(function(d) { return d.id; })                     // This provide  the id of a node
                .links(data.links)                                    // and this the list of links
          )
          .force("charge", d3.forceManyBody().strength(-400))         // This adds repulsion between nodes. Play with the -400 for the repulsion strength
          .force("center", d3.forceCenter(width / 2, height / 2))     // This force attracts nodes to the center of the svg area
          .on("end", ticked);

      // This function is run at each iteration of the force algorithm, updating the nodes position.
      function ticked() {
        link
          .attr("x1", function(d) { return d.source.x; })
          .attr("y1", function(d) { return d.source.y; })
          .attr("x2", function(d) { return d.target.x; })
          .attr("y2", function(d) { return d.target.y; });

        node
          .attr("transform", d => `translate(${d.x}, ${d.y})`)

        
        
        // // elem
        // //     .attr("cx", function(d) { return d.x+6; })
        // //     .attr("cy", function(d) { return d.y-6; });

        // g
        //   .attr("cx", function(d) { return d.x+6; })
        //   .attr("cy", function(d) { return d.y-6; });


        // // nodes
        // //   .attr("transform", function(d){ //<-- use transform it's not a g
        // //     return "translate(" + d.x + "," + d.y + ")";
        // //   });
      }

    }

    const data = {
      "nodes": [
        {id: 1, "x":40, y: 30, "r":20, "label":"Node 1"}, 
        {id: 2, "x":90, y: 30, "r":20, "label":"Node 2"}, 
        {id: 3, "x":140, y: 30, "r":20, "label":"Node 3"}
      ],
      "links": [
        { source: 1, target: 2 },
        { source: 1, target: 3 },
        { source: 2, target: 3 }
      ]
    }

    createGraph(data);

    </script>
  </body>
</html>
